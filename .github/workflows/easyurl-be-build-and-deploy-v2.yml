# Docs for the Azure Web Apps Deploy action: https://github.com/Azure/webapps-deploy
# More GitHub Actions for Azure: https://github.com/Azure/actions
# More info on Python, GitHub Actions, and Azure App Service: https://aka.ms/python-webapps-actions

name: Build and deploy - easyurlbe (TEST)

on:
  #push:
  #  branches:
  #    - main
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    environment:
      name: 'Production'

    steps:
      

      - uses: actions/checkout@v2

      - uses: Azure/login@v1
        with:
          creds: ${{ secrets.AZURE_CREDENTIALS }}
      
      - uses: flcdrg/get-azure-app-configuration-action@v2
        id: get-app-configuration
        with:
          resourceGroup: ${{ secrets.GB_APP_CONFIGURATION_RG }}
          appConfigurationName: ${{ secrets.GB_APP_CONFIGURATION_NAME }}
          keyFilter: "easyurlfe-FE_WEB_APP_URL"

      - run: |
          echo "::add-mask::$easyurlfe-FE_WEB_APP_URL" 
          echo "easyurlfe-FE_WEB_APP_URL=$easyurlfe-FE_WEB_APP_URL" >> $GITHUB_ENV

      - run: echo "Test!"
      
